<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
  </head>
<div>
    <h1>Gorcer HUB (Admin Panel)</h1>
    <a routerLink="/adminLogin">Logout</a>
    <mat-tab-group>

    <!-- Add Product -->
    <mat-tab label="Add Product">
        <form #productRef="ngForm" (ngSubmit)="addProduct(productRef.value)">
            <h1><b>Add Products</b></h1>
            <h3>
             Name
              <br />
              <input type="text" name="name" [(ngModel)]="name" required />
            </h3> 
            <h3>
              Price
              <br />
              $ <input type="number" min="0" oninput="validity.valid||(value='')" name="price" [(ngModel)]="price" required />
            </h3>
            <h3>
              Quantity
              <br />
              <input type="number"  min="0" oninput="validity.valid||(value='')" name="quantity" [(ngModel)]="quantity" required />
            </h3>
            
            <h3>
              Description
              <br />
              <input type="text" name="description" [(ngModel)]="description" required />
            </h3>
            <h3>
              Image Url
              <br />
             <input type="text" name="imageUrl" [(ngModel)]="imageUrl" required />
            </h3>
            <input type="reset" value="Clear" />
            <input type="submit" value="Add Product" [disabled]="!productRef.form.valid" />
            <div>
              {{addproductmessage}}
            </div>
          </form>
    </mat-tab>

<!-- Delete Product -->

    <mat-tab label="Delete Product">

        <form #deleteRef="ngForm" (ngSubmit)="deleteProduct(deleteRef.value)">
            <h1><b>Delete Products</b></h1>
            <h3>
             Name
              <br />
              <input type="text" name="name" [(ngModel)]="name" required />
            </h3>
            
            <input type="reset" value="Clear" />
            <input type="submit" value="Delete Product" [disabled]="!deleteRef.form.valid" />
            <div>
              {{deletemessage}}
            </div>
          </form>
    </mat-tab>





    <!-- update Product -->

    <mat-tab label="Update Product">

        <form #updateRef="ngForm" (ngSubmit)="updateProduct(updateRef.value)">
            <h1><b>Update Products</b></h1>
            <h3>
             Name
              <br />
              <input type="text" name="name" [(ngModel)]="name" required />
            </h3>
            <h3>
              Price
              <br />
              $ <input type="number" min="0"  oninput="validity.valid||(value='')" name="price" [(ngModel)]="price"  required/>
            </h3>
            <input type="reset" value="Clear" />
            <input type="submit" value="Update Product" [disabled]="!updateRef.form.valid" />
            <div>
              {{productMessage}}
            </div>
            </form>
        
            <form #quantityRef="ngForm" (ngSubmit)="updateQuantity(quantityRef.value)">
            <h1><b>Update Quantity</b></h1>
            <h3>
             Name
              <br />
              <input type="text" name="name1" [(ngModel)]="name1" required />
            </h3>
            <h3>
              Quantity
              <br />
              <input type="number" min="0" oninput="validity.valid||(value='')" name="quantity" [(ngModel)]="quantity" required/>
            </h3>
            <input type="reset" value="Clear" />
            <input type="submit" value="Update quantity" [disabled]="!quantityRef.form.valid" />
            <div>
              {{quantityMessage}}
            </div>
            </form>

    </mat-tab>

    <!-- View Request -->

    <mat-tab label="View Request">
<!--         
<table style=" display: flex; flex-flow: column;">
    <thead>
      <tr class="row" style="padding-top: 20px; padding-bottom: 20px; padding-right: 16px; background-color: seashell; border-bottom: 3px solid black; margin: 0; height: inherit;">
        <th class="col" style="padding: 0; text-align: center; display: flex; justify-content: center; align-items: center;"><div>Request Id</div></th>
        <th class="col" style="padding: 0; text-align: center; display: flex; justify-content: center; align-items: center;"><div>Username</div></th>
        <th class="col" style="padding: 0; text-align: center; display: flex; justify-content: center; align-items: center;"><div>Description</div></th>
        <th class="col" style="padding: 0; text-align: center; display: flex; justify-content: center; align-items: center;"><div>Status</div></th>
      </tr>
    </thead>
    <tbody id="tbody" style="flex-grow : 1; overflow-y: scroll; display:block; background-color: rgba(226, 248, 231, 0.97);" *ngIf="employeeRequests.length != 0">
      <tr class="row" id="selected_row" *ngFor="let requests of employeeRequests; let i = index" style="width: 100%; border: none; outline: none; padding: 0;" style="padding-top: 10px; padding-bottom: 10px; margin: 0;" [ngStyle]="{backgroundColor: i % 2 !== 0 ? 'rgba(226, 248, 231, 0.97)' : 'rgba(190, 239, 200, 0.97)'}" #tbody>
        <th class="col" style="padding: 0; text-align: center; display: block; width: 20px; word-wrap: break-word; margin: auto;"><div>{{requests._id}}</div></th>
        <th class="col" style="padding: 0; text-align: center; display: block; width: 20px; word-wrap: break-word; margin: auto;"><div>{{requests.username}}</div></th>
        <th class="col" style="padding: 0; text-align: center; display: block; width: 20px; word-wrap: break-word; margin: auto;"><div>{{requests.description}}</div></th>
        <th class="col" style="padding: 0; text-align: center; display: block; width: 20px; word-wrap: break-word; margin: auto;">
          <div style="display: flex; width: 14vw;" [ngSwitch]="requests.status">
              <select class="form-select" aria-label="Default select example" *ngSwitchCase="'Pending'" (change)="changeRequestStatus($event, requests)">
              <option value="Pending" selected>Pending</option>
              <option value="Completed">Completed</option>
              <option value="Rejected">Rejected</option>
            </select>
              <select class="form-select" aria-label="Default select example" *ngSwitchCase="'Completed'" (change)="changeRequestStatus($event, requests)">
              <option value="Completed" selected>Completed</option>
              <option value="Pending">Pending</option>
              <option value="Rejected">Rejected</option>
            </select>
              <select class="form-select" aria-label="Default select example" *ngSwitchCase="'Rejected'" (change)="changeRequestStatus($event, requests)">
              <option value="Rejected" selected>Rejected</option>
              <option value="Pending">Pending</option>
              <option value="Completed">Completed</option>
            </select>
          </div>
        </th>
      </tr>
    </tbody>
    <tfoot>
      <tr id="foot" class="row">
        <div style="display: flex; width: 100%; padding-right: 20px; flex-direction: row;">
          <div style="display: flex; flex : 1; justify-content: flex-end; align-items: center;">
            <button class="btn btn-success" (click)="updateRequests()" style="width: fit-content; height: 38px;">Update Requests</button>
          </div>
        </div>
      </tr>
    </tfoot>
  </table>
 -->

        
 <table style=" display: flex; flex-flow: column;">
  <thead>
    <tr class="row" style="padding-top: 20px; padding-bottom: 20px; padding-right: 16px; background-color: seashell; border-bottom: 3px solid black; margin: 0; height: inherit;">
      <th class="col" style="padding: 0; text-align: center; display: flex; justify-content: center; align-items: center;"><div>Request Id</div></th>
      <th class="col" style="padding: 0; text-align: center; display: flex; justify-content: center; align-items: center;"><div>Username</div></th>
      <th class="col" style="padding: 0; text-align: center; display: flex; justify-content: center; align-items: center;"><div>Description</div></th>
      <th class="col" style="padding: 0; text-align: center; display: flex; justify-content: center; align-items: center;"><div>Status</div></th>
    </tr>
  </thead>
  <tbody id="tbody" style="flex-grow : 1; overflow-y: scroll; display:contents; background-color: rgba(226, 248, 231, 0.97);" *ngIf="employeeRequests.length != 0">
    <tr class="row" id="selected_row" *ngFor="let requests of employeeRequests; let i = index" style="width: 100%; border: none; outline: none; padding: 0;" style="padding-top: 10px; padding-bottom: 10px; margin: 0;" [ngStyle]="{backgroundColor: i % 2 !== 0 ? 'rgba(226, 248, 231, 0.97)' : 'rgba(190, 239, 200, 0.97)'}" #tbody>
      <th class="col" style="padding: 0; text-align: center; display: block; width: 20px; word-wrap: break-word; margin: auto;"><div>{{requests.requestid}}</div></th>
      <th class="col" style="padding: 0; text-align: center; display: block; width: 20px; word-wrap: break-word; margin: auto;"><div>{{requests.username}}</div></th>
      <th class="col" style="padding: 0; text-align: center; display: block; width: 20px; word-wrap: break-word; margin: auto;"><div>{{requests.description}}</div></th>
      <th class="col" style="padding: 0; text-align: center; display: block; width: 20px; word-wrap: break-word; margin: auto;">
        <div style="display: flex; width: 14vw;" [ngSwitch]="requests.status">
            <select class="form-select" aria-label="Default select example" *ngSwitchCase="'Pending'" (change)="changeRequestStatus($event, requests)">
            <option value="Pending" selected>Pending</option>
            <option value="Completed">Completed</option>
            <option value="Rejected">Rejected</option>
          </select>
            <select class="form-select" aria-label="Default select example" *ngSwitchCase="'Completed'" (change)="changeRequestStatus($event, requests)">
            <option value="Completed" selected>Completed</option>
            <option value="Pending">Pending</option>
            <option value="Rejected">Rejected</option>
          </select>
            <select class="form-select" aria-label="Default select example" *ngSwitchCase="'Rejected'" (change)="changeRequestStatus($event, requests)">
            <option value="Rejected" selected>Rejected</option>
            <option value="Pending">Pending</option>
            <option value="Completed">Completed</option>
          </select>
        </div>
      </th>
    </tr>
  </tbody>
  <tfoot>
    <tr id="foot" class="row">
      <div style="display: flex; width: 100%; padding-right: 20px; flex-direction: row;">
        <div style="display: flex; flex : 1; justify-content: flex-end; align-items: center;">
          <button class="btn btn-success" (click)="updateRequests()" style="width: fit-content; height: 38px;">Update Requests</button>
        </div>
      </div>
    </tr>
  </tfoot>
</table>



    </mat-tab>




        <mat-tab label="Add Employee">
            <!--Add employee form-->
            <h2>Add an Employee Account</h2>
            <form class="form-dimensions" #addEmployeeRef="ngForm" (ngSubmit)="addEmployee(addEmployeeRef)">
                <mat-form-field style="width: 35%;">
                    <mat-label>First Name</mat-label>
                    <input matInput name="firstname" ngModel required>
                </mat-form-field>
                &nbsp;
                <mat-form-field style="width: 35%;">
                    <mat-label>Last Name</mat-label>
                    <input matInput name="lastname" ngModel required>
                </mat-form-field>
                <br>
                <mat-form-field class="full-width">
                    <mat-label>Email</mat-label>
                    <input matInput type="email" name="email" placeholder="john@example.com" ngModel required>
                </mat-form-field>
                <br>
                <mat-form-field class="full-width">
                    <mat-label>Default Password</mat-label>
                    <input matInput type="text" name="password" ngModel required>
                </mat-form-field>
                <br>
                <button type="submit" mat-raised-button color="primary" [disabled]="addEmployeeRef.invalid">Create Account</button>
            </form>
        </mat-tab>


        <mat-tab label="Delete Employee">
            <!--Delete employee form-->
            <h2>Delete an Employee Account</h2>
            <form class="form-dimensions" #delEmployeeRef="ngForm" (ngSubmit)="deleteEmployee(delEmployeeRef)">
                <mat-form-field>
                    <mat-label>Employee ID</mat-label>
                    <input matInput name="empid" minlength="6" ngModel required>
                </mat-form-field>
                <br>
                <button type="submit" mat-raised-button color="primary" [disabled]="delEmployeeRef.invalid">Delete</button>
            </form>
        </mat-tab>
        <mat-tab label="Generate Reports">
            <!--Generate reports-->
            <h2>Generate Reports</h2>
            <form class="form-dimensions" #reportRef="ngForm" (ngSubmit)="generateReports(reportRef)">
                <mat-form-field>
                    <mat-label>Time</mat-label>
                    <select matNativeControl name="reporttype" ngModel required>
                        <option value="daily">Daily</option>
                        <option value="weekly">Weekly</option>
                        <option value="monthly">Monthly</option>
                    </select>
                </mat-form-field>
                &nbsp;
                <mat-form-field>
                    <mat-label>User ID</mat-label>
                    <input matInput name="userId" ngModel>
                </mat-form-field>
                &nbsp;
                <mat-form-field>
                    <mat-label>Product Name</mat-label>
                    <input matInput name="productId" ngModel>
                </mat-form-field>
                <br>
                <button type="submit" mat-raised-button color="primary" [disabled]="reportRef.invalid">Generate</button>
            </form>
            <br>
            <hr>
            <!--Generation results go here-->
            <div>
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>User ID</th>
                            <th>Product Name</th>
                            <th>Date of Purchase</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngFor="let report of reportArray">
                            <td>{{report.userid}}</td>
                            <td>{{report.product}}</td>
                            <td>{{report.month+1}}-{{report.day}}-{{report.year}}</td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
        </mat-tab>
    </mat-tab-group>
</div>
